<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <title>AUTHENTICATION &mdash; Gcloud Documentation</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//googlecloudplatform.github.io/gcloud-ruby/css/normalize.css">
    <link rel="stylesheet" href="//googlecloudplatform.github.io/gcloud-ruby/css/main.css">
    <script src="//googlecloudplatform.github.io/gcloud-ruby/js/vendor/modernizr-2.6.2.min.js"></script>
    <link href='//fonts.googleapis.com/css?family=Droid+Sans+Mono|Roboto:300,400,700,700italic,400italic|Open+Sans:300' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" href="https://cloud.google.com/images/gcp-favicon.ico">
  </head>

  <body class="lang-page">
    <!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <header class="page-header fixed" role="banner">
      <h1 class="logo">
        <a href="//googlecloudplatform.github.io/gcloud-ruby/" title="back to home">
          <img src="//googlecloudplatform.github.io/gcloud-ruby/img/logo.svg" alt="Google Cloud Platform">
          <span class="gcloud">gcloud</span>
        </a>
      </h1>

      <nav class="main-nav">
        <div class="nav-current">Ruby</div>
        <ul class="menu">
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-java/" title="gcloud-java">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-java.svg" alt="Java icon" class="menu-icon" />
              Java
            </a>
          </li>
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-node/#/docs" title="gcloud-node">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-nodejs.svg" alt="Node.js icon" class="menu-icon">
              Node.js
            </a>
          </li>
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-python/latest/" title="gcloud-python">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-python.svg" alt="Python icon" class="menu-icon">
              Python
            </a>
          </li>
          <li>
            <a href="//googlecloudplatform.github.io/gcloud-ruby/" title="gcloud-ruby">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-lang-ruby.svg" alt="Ruby icon" class="menu-icon" width="24">
              Ruby
            </a>
          </li>
        </ul>
      </nav>

      <div class="github-issue">
        <a href="https://github.com/GoogleCloudPlatform/gcloud-ruby/issues/new?title=%5BDocumentation+Issue%5D+" target="_blank" class="v-btn">
          <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-github.svg" />
          Report an Issue
        </a>
      </div>
    </header>

    <article class="main lang-page" role="main">

      <header class="docs-header">
        <h1 class="page-title">AUTHENTICATION</h1>
      </header>

      <section class="content">
        <h1 id="authentication">Authentication</h1>

<h2 id="creating-a-service-account">Creating a Service Account</h2>

<p>The gcloud-ruby library aims to make authentication as simple as possible. Google Cloud requires a <strong>Project ID</strong> and <strong>Service Account Credentials</strong> to connect to the APIs. To create a service account:</p>

<ol>
  <li>Visit the <a href="https://console.developers.google.com/project">Google Developers Console Projects page</a>.</li>
  <li>Create a new project or click on an existing project that you wish to use.</li>
  <li>In the project’s <strong>Dashboard</strong>, under <strong>Explore other services</strong>, click <strong>Enable APIs and get credentials like keys</strong>.</li>
  <li>Turn on one or more of the following APIs by clicking on each API name and then clicking <strong>Enable API</strong> (click <strong>More</strong> if you do not see an API; also, you may need to enable billing in order to use some services):
    <ul>
      <li>BigQuery API</li>
      <li>Cloud Datastore API</li>
      <li>Cloud DNS API</li>
      <li>Cloud Pub/Sub API</li>
      <li>Cloud Storage Service</li>
      <li>Cloud Storage JSON API</li>
    </ul>
  </li>
  <li>In the left nav, click <strong>Credentials</strong>.</li>
  <li>Under <strong>New credentials</strong>, select <strong>Service account key</strong>.</li>
  <li>If you want to create a new service account, under <strong>Service account</strong>, select <strong>New service account</strong>. Otherwise, select an existing service account. Submit the form to download a JSON type key. Save the downloaded JSON key file to authorize your requests.</li>
</ol>

<p>You will use the <strong>Project ID</strong> and <strong>JSON file</strong> to connect to services with gcloud-ruby.</p>

<h2 id="project-and-credential-lookup">Project and Credential Lookup</h2>

<p>The gcloud-ruby library aims to make authentication as simple as possible, and provides several mechanisms to configure your system without providing <strong>Project ID</strong> and <strong>Service Account Credentials</strong> directly in code.</p>

<p><strong>Project ID</strong> is discovered in the following order:</p>

<ol>
  <li>Specify project ID in code</li>
  <li>Discover project ID in environment variables</li>
  <li>Discover GCE project ID</li>
</ol>

<p><strong>Credentials</strong> are discovered in the following order:</p>

<ol>
  <li>Specify credentials in code</li>
  <li>Discover credentials path in environment variables</li>
  <li>Discover credentials JSON in environment variables</li>
  <li>Discover credentials file in the Cloud SDK’s path</li>
  <li>Discover GCE credentials</li>
</ol>

<h3 id="compute-engine">Compute Engine</h3>

<p>While running on Google Compute Engine no extra work is needed. The <strong>Project ID</strong> and <strong>Credentials</strong> and are discovered automatically. Code should be written as if already authenticated.</p>

<h3 id="environment-variables">Environment Variables</h3>

<p>The <strong>Project ID</strong> and <strong>Credentials JSON</strong> can be placed in environment variables instead of declaring them directly in code. Each service has its own environment variable, allowing for different service accounts to be used for different services. The path to the <strong>Credentials JSON</strong> file can be stored in the environment variable, or the <strong>Credentials JSON</strong> itself can be stored for environments such as Docker containers where writing files is difficult or not encouraged.</p>

<p>Here are the environment variables that Datastore checks for project ID:</p>

<ol>
  <li>DATASTORE_PROJECT</li>
  <li>GCLOUD_PROJECT</li>
</ol>

<p>Here are the environment variables that Datastore checks for credentials:</p>

<ol>
  <li>DATASTORE_KEYFILE - Path to JSON file</li>
  <li>GCLOUD_KEYFILE - Path to JSON file</li>
  <li>DATASTORE_KEYFILE_JSON - JSON contents</li>
  <li>GCLOUD_KEYFILE_JSON - JSON contents</li>
</ol>

<h3 id="cloud-sdk">Cloud SDK</h3>

<p>This option allows for an easy way to authenticate during development. If credentials are not provided in code or in environment variables, then Cloud SDK credentials are discovered.</p>

<p>To configure your system for this, simply:</p>

<ol>
  <li><a href="https://cloud.google.com/sdk">Download and install the Cloud SDK</a></li>
  <li>Authenticate using OAuth 2.0 <code class="highlighter-rouge">$ gcloud auth login</code></li>
  <li>Write code as if already authenticated.</li>
</ol>

<p><strong>NOTE:</strong> This is <em>not</em> recommended for running in production. The Cloud SDK should only be used during development.</p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>If you’re having trouble authenticating open a <a href="https://github.com/GoogleCloudPlatform/gcloud-ruby/issues/new?title=Authentication+question">Github Issue</a> to get help.  Also consider searching or asking <a href="http://stackoverflow.com/questions/tagged/gcloud-ruby">questions</a> on <a href="http://stackoverflow.com">StackOverflow</a>.</p>

        
      </section>

      <nav class="side-nav">

        <div class="side-nav--meta"><div id="doc-build-date">Docs built on Jun 27, 2016.</div></div><ul><h4 class="list-item--heading">Getting Started</h4><li class='toc-l0'><a class='reference internal' href='index.html'>Overview</a></li><li class='toc-l0'><a class='reference internal current' href='AUTHENTICATION.html'>Authentication Guide</a></li></ul><ul><h4 class="list-item--heading">API</h4><li class='toc-l0'><a class='reference internal' href='Gcloud.html'>Gcloud</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/Bigquery.html'>BigQuery</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/Datastore.html'>Datastore</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/Dns.html'>DNS</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/Logging.html'>Logging</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/Pubsub.html'>Pub/Sub</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/ResourceManager.html'>Resource Manager</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/Storage.html'>Storage</a></li><li class='toc-l0'><a class='reference internal' href='Gcloud/Translate.html'>Translate</a></li><li class='toc-l0'><a class='reference internal' href='reference.html'>API Reference</a></li></ul>

        <ul class="external-links">
          <li>
            <a href="https://github.com/GoogleCloudPlatform/gcloud-ruby" title="Github repository">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-github.svg" alt="Github icon">
              Github
            </a>
          </li>
          <li>
            <a href="https://github.com/GoogleCloudPlatform/gcloud-ruby/issues" title="Issues on Github">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-issues.svg" alt="Issues icon">
              Issues
            </a>
          </li>
          <li>
            <a href="http://stackoverflow.com/questions/tagged/gcloud-ruby" title="gcloud on StackOverflow">
              <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-stackoverflow.svg" alt="StackOverflow icon">
              StackOverflow
            </a>
          </li>
          <li>
            <a href="http://rubygems.org/gems/gcloud" title="RubyGems" class="ext-link">
               <img src="//googlecloudplatform.github.io/gcloud-ruby/img/icon-link-rubygems.svg" alt="RubyGems icon">
              RubyGems
            </a>
          </li>
        </ul>

      </nav>

    </article>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script ="//googlecloudplatform.github.io/gcloud-ruby/js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
    <script src="//googlecloudplatform.github.io/gcloud-ruby/js/plugins.js"></script>
    <script src="//googlecloudplatform.github.io/gcloud-ruby/js/main.js"></script>

    <script>
      (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
      function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
      e=o.createElement(i);r=o.getElementsByTagName(i)[0];
      e.src='//www.google-analytics.com/analytics.js';
      r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
      ga('create','UA-49880327-13');ga('send','pageview');
    </script>

  </body>
</html>
