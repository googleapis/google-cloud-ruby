---
layout: yard_main
title: "Class: Google::Cloud::Bigquery::External::SheetsSource - Google"
css: 
  - /docs/css/style.css
  - /docs/css/common.css
  - /css/docs.css
js: 
  - /docs/js/app.js
  - /js/docs.js
---
<script type="text/javascript" charset="utf-8">
  pathId = "Google::Cloud::Bigquery::External::SheetsSource";
  relpath = '../../../../';
</script>


<div class="nav_wrap">
  <iframe id="nav" src="../../../../class_list.html?1"></iframe>
  <div id="resizer"></div>
</div>

<div id="main" tabindex="-1">
  <div id="header">
    <div id="menu">
  
    <a href="../../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Google.html" title="Google (module)">Google</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Bigquery.html" title="Google::Cloud::Bigquery (module)">Bigquery</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../External.html" title="Google::Cloud::Bigquery::External (module)">External</a></span></span>
     &raquo; 
    <span class="title">SheetsSource</span>
  
</div>

    <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
    <div class="clear"></div>
  </div>

  <div id="content"><h1>Class: Google::Cloud::Bigquery::External::SheetsSource
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="DataSource.html" title="Google::Cloud::Bigquery::External::DataSource (class)">DataSource</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="DataSource.html" title="Google::Cloud::Bigquery::External::DataSource (class)">DataSource</a></span></li>
          
            <li class="next">Google::Cloud::Bigquery::External::SheetsSource</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/google/cloud/bigquery/external.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h1>SheetsSource</h1>

<p><span class='object_link'><a href="" title="Google::Cloud::Bigquery::External::SheetsSource (class)">SheetsSource</a></span> is a subclass of <span class='object_link'><a href="DataSource.html" title="Google::Cloud::Bigquery::External::DataSource (class)">DataSource</a></span> and
represents a Google Sheets external data source that can be queried
from directly, even though the data is not stored in BigQuery. Instead
of loading or streaming the data, this object references the external
data source.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/bigquery</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_bigquery'>bigquery</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Bigquery.html" title="Google::Cloud::Bigquery (module)">Bigquery</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Bigquery.html#new-class_method" title="Google::Cloud::Bigquery.new (method)">new</a></span></span>

<span class='id identifier rubyid_sheets_url'>sheets_url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://docs.google.com/spreadsheets/d/1234567980</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sheets_table'>sheets_table</span> <span class='op'>=</span> <span class='id identifier rubyid_bigquery'>bigquery</span><span class='period'>.</span><span class='id identifier rubyid_external'>external</span> <span class='id identifier rubyid_sheets_url'>sheets_url</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sheets'>sheets</span><span class='op'>|</span>
  <span class='id identifier rubyid_sheets'>sheets</span><span class='period'>.</span><span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_bigquery'>bigquery</span><span class='period'>.</span><span class='id identifier rubyid_query'>query</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM my_ext_table</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                      <span class='label'>external:</span> <span class='lbrace'>{</span> <span class='label'>my_ext_table:</span> <span class='id identifier rubyid_sheets_table'>sheets_table</span> <span class='rbrace'>}</span>

<span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#skip_leading_rows-instance_method" title="#skip_leading_rows (instance method)">#<strong>skip_leading_rows</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The number of rows at the top of a sheet that BigQuery will skip when reading the data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#skip_leading_rows=-instance_method" title="#skip_leading_rows= (instance method)">#<strong>skip_leading_rows=</strong>(row_count)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Set the number of rows at the top of a sheet that BigQuery will skip when reading the data.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="DataSource.html" title="Google::Cloud::Bigquery::External::DataSource (class)">DataSource</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="DataSource.html#autodetect-instance_method" title="Google::Cloud::Bigquery::External::DataSource#autodetect (method)">#autodetect</a></span>, <span class='object_link'><a href="DataSource.html#autodetect=-instance_method" title="Google::Cloud::Bigquery::External::DataSource#autodetect= (method)">#autodetect=</a></span>, <span class='object_link'><a href="DataSource.html#avro%3F-instance_method" title="Google::Cloud::Bigquery::External::DataSource#avro? (method)">#avro?</a></span>, <span class='object_link'><a href="DataSource.html#backup%3F-instance_method" title="Google::Cloud::Bigquery::External::DataSource#backup? (method)">#backup?</a></span>, <span class='object_link'><a href="DataSource.html#bigtable%3F-instance_method" title="Google::Cloud::Bigquery::External::DataSource#bigtable? (method)">#bigtable?</a></span>, <span class='object_link'><a href="DataSource.html#compression-instance_method" title="Google::Cloud::Bigquery::External::DataSource#compression (method)">#compression</a></span>, <span class='object_link'><a href="DataSource.html#compression=-instance_method" title="Google::Cloud::Bigquery::External::DataSource#compression= (method)">#compression=</a></span>, <span class='object_link'><a href="DataSource.html#csv%3F-instance_method" title="Google::Cloud::Bigquery::External::DataSource#csv? (method)">#csv?</a></span>, <span class='object_link'><a href="DataSource.html#format-instance_method" title="Google::Cloud::Bigquery::External::DataSource#format (method)">#format</a></span>, <span class='object_link'><a href="DataSource.html#ignore_unknown-instance_method" title="Google::Cloud::Bigquery::External::DataSource#ignore_unknown (method)">#ignore_unknown</a></span>, <span class='object_link'><a href="DataSource.html#ignore_unknown=-instance_method" title="Google::Cloud::Bigquery::External::DataSource#ignore_unknown= (method)">#ignore_unknown=</a></span>, <span class='object_link'><a href="DataSource.html#json%3F-instance_method" title="Google::Cloud::Bigquery::External::DataSource#json? (method)">#json?</a></span>, <span class='object_link'><a href="DataSource.html#max_bad_records-instance_method" title="Google::Cloud::Bigquery::External::DataSource#max_bad_records (method)">#max_bad_records</a></span>, <span class='object_link'><a href="DataSource.html#max_bad_records=-instance_method" title="Google::Cloud::Bigquery::External::DataSource#max_bad_records= (method)">#max_bad_records=</a></span>, <span class='object_link'><a href="DataSource.html#sheets%3F-instance_method" title="Google::Cloud::Bigquery::External::DataSource#sheets? (method)">#sheets?</a></span>, <span class='object_link'><a href="DataSource.html#urls-instance_method" title="Google::Cloud::Bigquery::External::DataSource#urls (method)">#urls</a></span></p>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="skip_leading_rows-instance_method">
  
    #<strong>skip_leading_rows</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The number of rows at the top of a sheet that BigQuery will skip
when reading the data. The default value is <code>0</code>.</p>

<p>This property is useful if you have header rows that should be
skipped. When <code>autodetect</code> is on, behavior is the following:</p>

<ul>
<li><code>nil</code> - Autodetect tries to detect headers in the first row. If
they are not detected, the row is read as data. Otherwise data is
read starting from the second row.</li>
<li><code>0</code> - Instructs autodetect that there are no headers and data
should be read starting from the first row.</li>
<li><code>N &gt; 0</code> - Autodetect skips <code>N-1</code> rows and tries to detect headers
in row <code>N</code>. If headers are not detected, row <code>N</code> is just skipped.
Otherwise row <code>N</code> is used to extract column names for the detected
schema.</li>
</ul>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/bigquery</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_bigquery'>bigquery</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Bigquery.html" title="Google::Cloud::Bigquery (module)">Bigquery</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Bigquery.html#new-class_method" title="Google::Cloud::Bigquery.new (method)">new</a></span></span>

<span class='id identifier rubyid_sheets_url'>sheets_url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://docs.google.com/spreadsheets/d/1234567980</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sheets_table'>sheets_table</span> <span class='op'>=</span> <span class='id identifier rubyid_bigquery'>bigquery</span><span class='period'>.</span><span class='id identifier rubyid_external'>external</span> <span class='id identifier rubyid_sheets_url'>sheets_url</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sheets'>sheets</span><span class='op'>|</span>
  <span class='id identifier rubyid_sheets'>sheets</span><span class='period'>.</span><span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_sheets_table'>sheets_table</span><span class='period'>.</span><span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span> <span class='comment'>#=&gt; 1</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1201
1202
1203</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/bigquery/external.rb', line 1201</span>

<span class='kw'>def</span> <span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span>
  <span class='ivar'>@gapi</span><span class='period'>.</span><span class='id identifier rubyid_google_sheets_options'>google_sheets_options</span><span class='period'>.</span><span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="skip_leading_rows=-instance_method">
  
    #<strong>skip_leading_rows=</strong>(row_count)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Set the number of rows at the top of a sheet that BigQuery will skip
when reading the data.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/bigquery</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_bigquery'>bigquery</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Bigquery.html" title="Google::Cloud::Bigquery (module)">Bigquery</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Bigquery.html#new-class_method" title="Google::Cloud::Bigquery.new (method)">new</a></span></span>

<span class='id identifier rubyid_sheets_url'>sheets_url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://docs.google.com/spreadsheets/d/1234567980</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sheets_table'>sheets_table</span> <span class='op'>=</span> <span class='id identifier rubyid_bigquery'>bigquery</span><span class='period'>.</span><span class='id identifier rubyid_external'>external</span> <span class='id identifier rubyid_sheets_url'>sheets_url</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sheets'>sheets</span><span class='op'>|</span>
  <span class='id identifier rubyid_sheets'>sheets</span><span class='period'>.</span><span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span> <span class='op'>=</span> <span class='int'>1</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_sheets_table'>sheets_table</span><span class='period'>.</span><span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span> <span class='comment'>#=&gt; 1</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>row_count</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>New skip_leading_rows value</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1223
1224
1225
1226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/bigquery/external.rb', line 1223</span>

<span class='kw'>def</span> <span class='id identifier rubyid_skip_leading_rows='>skip_leading_rows=</span> <span class='id identifier rubyid_row_count'>row_count</span>
  <span class='id identifier rubyid_frozen_check!'>frozen_check!</span>
  <span class='ivar'>@gapi</span><span class='period'>.</span><span class='id identifier rubyid_google_sheets_options'>google_sheets_options</span><span class='period'>.</span><span class='id identifier rubyid_skip_leading_rows'>skip_leading_rows</span> <span class='op'>=</span> <span class='id identifier rubyid_row_count'>row_count</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

  <div id="footer">
  <ul class="footer-links">
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby" title="Google Cloud on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> GitHub
      </a>
    </li>
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby/issues" title="Google Cloud issues on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> Issues
      </a>
    </li>
    <li>
      <a href="http://stackoverflow.com/questions/tagged/google-cloud-ruby" title="Google Cloud on StackOverflow">
      <img src="/google-cloud-ruby/img/icon-link-stackoverflow.svg" alt="StackOverflow icon"> StackOverflow
    </a>
    </li>
    <li>
      <a href="http://rubygems.org/gems/google-cloud" title="Google Cloud on RubyGems">
        <img src="/google-cloud-ruby/img/icon-link-package-manager.svg" alt="RubyGems icon"> RubyGems
      </a>
    </li>
  </ul>

  <p>
    Documentation generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>.
  </p>
</div>

</div>
