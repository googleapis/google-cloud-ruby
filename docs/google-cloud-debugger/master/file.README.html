---
layout: yard_main
title: "File: README - Stackdriver"
css: 
  - /docs/css/style.css
  - /docs/css/common.css
  - /css/yard-main.css
js: 
  - /docs/js/app.js
  - /js/yard-main.js
---
<script type="text/javascript" charset="utf-8">
  pathId = "README";
  relpath = '';
</script>


<div class="nav_wrap">
  <iframe id="nav" src="file_list.html?1"></iframe>
  <div id="resizer"></div>
</div>

<div id="main" tabindex="-1">
  <div id="header">
    <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

    <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
    <div class="clear"></div>
  </div>

  <div id="content"><div id='filecontents'><h1>google-cloud-debugger</h1>

<p><a href="https://cloud.google.com/debugger/">Stackdriver Debugger</a> lets you inspect the
state of a running application at any code location in real time, without
stopping or slowing down the application, and without modifying the code to add
logging statements. You can use Stackdriver Debugger with any deployment of
your application, including test, development, and production. The Ruby
debugger adds minimal request latency, typically less than 50ms, and only when
application state is captured. In most cases, this is not noticeable by users.</p>

<ul>
<li><a href="http://googlecloudplatform.github.io/google-cloud-ruby/#/docs/google-cloud-debugger/master/google/cloud/debugger">google-cloud-debugger documentation</a></li>
<li><a href="https://rubygems.org/gems/google-cloud-debugger">google-cloud-debugger on RubyGems</a></li>
<li><a href="https://cloud.google.com/debugger/docs/">Stackdriver Debugger documentation</a></li>
</ul>

<h2>Quick Start</h2>

<h3>Installing the gem</h3>

<p>Add the <code>google-cloud-debugger</code> gem to your Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google-cloud-debugger</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>Alternatively, consider installing the <a href="../stackdriver"><code>stackdriver</code></a> gem. It
includes the <code>google-cloud-debugger</code> gem as a dependency, and automatically
initializes it for some application frameworks.</p>

<h3>Initializing the Debugger</h3>

<p>The Stackdriver Debugger library provides a Debugger agent that helps create
breakpoints in your running applications. It then collects application snapshot
data and transmits it to the Stackdriver Debugger service for you to view on
the Google Cloud Console. The library also comes with a Railtie and a Rack
Middleware to help control the Debugger agent in popular Rack based frameworks,
such as Ruby on Rails and Sinatra.</p>

<h4>Setup with Ruby on Rails</h4>

<p>You can load the Railtie that comes with the library into your Ruby
on Rails application by explicitly requiring it during the application startup:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># In config/application.rb
</span><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/debugger/rails</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>If you&#39;re using the <code>stackdriver</code> gem, it automatically loads the Railtie into
your application when it starts.</p>

<h4>Setup with other Rack-based frameworks</h4>

<p>Other Rack-based frameworks, such as Sinatra, can use the Rack Middleware
provided by the library:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/debugger</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_use'>use</span> <span class='const'><span class='object_link'><a href="Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud/Debugger.html" title="Google::Cloud::Debugger (module)">Debugger</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud/Debugger/Middleware.html" title="Google::Cloud::Debugger::Middleware (class)">Middleware</a></span></span>
</code></pre>

<h4>Setup without a Rack-based framework</h4>

<p>Non-rack-based applications can start the agent explicitly during the
initialization code:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/debugger</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><span class='object_link'><a href="Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud/Debugger.html" title="Google::Cloud::Debugger (module)">Debugger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Google/Cloud/Debugger.html#new-class_method" title="Google::Cloud::Debugger.new (method)">new</a></span></span><span class='period'>.</span><span class='id identifier rubyid_start'><span class='object_link'><a href="Google/Cloud/Debugger/Project.html#start-instance_method" title="Google::Cloud::Debugger::Project#start (method)">start</a></span></span>
</code></pre>

<h3>Connecting to the Debugger</h3>

<p>You can set breakpoints and view snapshots using the Google Cloud Console.
If your app is hosted on Google Cloud (such as on Google App Engine, Google
Kubernetes Engine, or Google Compute Engine), you can use the same project.
Otherwise, if your application is hosted elsewhere, create a new project on
<a href="https://console.cloud.google.com/">Google Cloud</a>.</p>

<p>Make sure the
<a href="https://console.cloud.google.com/apis/library/clouddebugger.googleapis.com">Stackdriver Debugger API</a>
is enabled on your Google Cloud project.</p>

<p>To connect to the Stackdriver Debugger service, the agent needs to be
authenticated. If your application is hosted on Google Cloud Platform, much of
this is handled for you automatically.</p>

<h4>Connecting from Google App Engine (GAE)</h4>

<p>If your app is running on Google App Engine, the Stackdriver Debugger agent
authenticates automatically by default, and no additional configuration is
required.</p>

<h4>Connecting from Google Kubernetes Engine (GKE)</h4>

<p>If your app is running on Google Kubernetes Engine, you must explicitly add the
<code>cloud_debugger</code> OAuth scope when creating the cluster:</p>

<pre class="code sh"><code class="sh">$ gcloud container clusters create example-cluster-name --scopes https://www.googleapis.com/auth/cloud_debugger
</code></pre>

<p>You can also do this through the Google Cloud Platform Console. Select
<strong>Enabled</strong> in the Cloud Platform section of <strong>Create a container cluster</strong>.</p>

<p>After the OAuth scope is enabled, the Stackdriver Debugger agent authenticates
automatically by default, and no additional configuration is required.</p>

<h4>Connecting from Google Compute Engine (GCE)</h4>

<p>If your app is running on Google Compute Engine, its VM instances should have
one of the following access scopes. These are only relevant when you use
Compute Engine&#39;s default service account:</p>

<ul>
<li><code>https://www.googleapis.com/auth/cloud-platform</code></li>
<li><code>https://www.googleapis.com/auth/cloud_debugger</code></li>
</ul>

<p>The <code>cloud-platform</code> access scope can be supplied when creating a new instance
through the Google Cloud Platform Console. Select <strong>Allow full access to all
Cloud APIs</strong> in the <strong>Identity and API access</strong> section of <strong>Create an
instance</strong>.</p>

<p>The <code>cloud_debugger</code> access scope can be supplied manually using the SDK&#39;s
<code>gcloud compute instances create</code> command or the <code>gcloud compute instances
set-service-account</code> command.</p>

<p>After the OAuth scope is enabled, the Stackdriver Debugger agent authenticates
automatically by default using the VM&#39;s service account, and no additional
configuration is required.</p>

<h4>Connecting from other hosting environments</h4>

<p>To run the Stackdriver Debugger agent outside of Google Cloud Platform, you must
supply your GCP project ID and appropriate service account credentials directly
to the Stackdriver Debugger agent. This applies to running the agent on your own
workstation, on your datacenter&#39;s computers, or on the VM instances of another
cloud provider.</p>

<p>The best way to provide authentication information if you&#39;re using Ruby on Rails
is through the Rails configuration interface:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># in config/environments/*.rb
</span><span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_application'>application</span><span class='period'>.</span><span class='id identifier rubyid_configure'>configure</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_config'>config</span><span class='op'>|</span>
  <span class='comment'># Shared parameters
</span>  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_google_cloud'>google_cloud</span><span class='period'>.</span><span class='id identifier rubyid_project_id'>project_id</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>your-project-id</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_google_cloud'>google_cloud</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/path/to/key.json</span><span class='tstring_end'>&quot;</span></span>
  <span class='comment'># Or Stackdriver Debugger agent specific parameters
</span>  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_google_cloud'>google_cloud</span><span class='period'>.</span><span class='id identifier rubyid_debugger'>debugger</span><span class='period'>.</span><span class='id identifier rubyid_project_id'>project_id</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>your-project-id</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_google_cloud'>google_cloud</span><span class='period'>.</span><span class='id identifier rubyid_debugger'>debugger</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/path/to/key.json</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>Other Rack-based applications that are loading the Rack Middleware directly can
use the configration interface:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/debugger</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><span class='object_link'><a href="Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='period'>.</span><span class='id identifier rubyid_configure'>configure</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_config'>config</span><span class='op'>|</span>
  <span class='comment'># Shared parameters
</span>  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_project_id'>project_id</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>your-project-id</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/path/to/key.json</span><span class='tstring_end'>&quot;</span></span>
  <span class='comment'># Or Stackdriver Debugger agent specific parameters
</span>  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_debugger'>debugger</span><span class='period'>.</span><span class='id identifier rubyid_project_id'>project_id</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>your-project-id</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_debugger'>debugger</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/path/to/key.json</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>Or provide the parameters to the Stackdriver Debugger agent when it starts:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/debugger</span><span class='tstring_end'>&quot;</span></span>
<span class='const'><span class='object_link'><a href="Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud/Debugger.html" title="Google::Cloud::Debugger (module)">Debugger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Google/Cloud/Debugger.html#new-class_method" title="Google::Cloud::Debugger.new (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>project_id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>your-project-id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                            <span class='label'>credentials:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/path/to/key.json</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_start'><span class='object_link'><a href="Google/Cloud/Debugger/Project.html#start-instance_method" title="Google::Cloud::Debugger::Project#start (method)">start</a></span></span>
</code></pre>

<p>This library also supports the other authentication methods provided by the
<code>google-cloud-ruby</code> suite. Instructions and configuration options are covered
in the <a href="https://googlecloudplatform.github.io/google-cloud-ruby/#/docs/google-cloud-debugger/guides/authentication">Authentication Guide</a>.</p>

<h3>Using the Debugger</h3>

<p>When you set a breakpoint in the Stackdriver Debugger console, the agent takes
a snapshot of application data when the breakpoint is hit. The application then
continues running with minimal slowdown, and you can view the snapshot offline
in the console.</p>

<p>By default, the snapshot includes the local variables from the current and four
most recent stack frames. You may include additional data in the snapshot by
providing a list of <em>expressions</em> when you create the breakpoint. Expressions
may be instance variables, global variables, or the result of calling Ruby
methods, or indeed, any Ruby expression.</p>

<p>For more information on using the debugger features, see the
<a href="https://cloud.google.com/debugger/docs/">Stackdriver Debugger Documentation</a>.</p>

<h4>Working with Mutation Protection</h4>

<p>To reduce the risk of corrupting your application data or changing your
application&#39;s behavior, the debugger agent checks all expressions you provide
for possible side effects before it runs them. If an expression calls any code
that could modify the program state, by changing an instance variable for
example, it is not evaluated.</p>

<p>This check is rather conservative, so if you are receiving mutation errors on
an expression you know to be safe, you may disable the check by wrapping your
expression in a call to <code>Google::Cloud::Debugger.allow_mutating_methods!</code>. For
example:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Google/Cloud/Debugger.html" title="Google::Cloud::Debugger (module)">Debugger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_allow_mutating_methods!'><span class='object_link'><a href="Google/Cloud/Debugger.html#allow_mutating_methods!-class_method" title="Google::Cloud::Debugger.allow_mutating_methods! (method)">allow_mutating_methods!</a></span></span> <span class='lbrace'>{</span> <span class='id identifier rubyid_my_expression'>my_expression</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
</code></pre>

<p>You may disable side effect checks globally by setting the
<code>allow_mutating_methods</code> configuration. See the next section on configuring the
agent.</p>

<h4>Configuring the agent</h4>

<p>You can customize the behavior of the Stackdriver Debugger agent. This includes
setting the Google Cloud project and authentication, and customizing the
behavior of the debugger itself, such as side effect protection and data
size limits. See <a href="../stackdriver/CONFIGURATION.md">agent configuration</a>
for a list of possible configuration options.</p>

<h2>Enabling Logging</h2>

<p>To enable logging for this library, set the logger for the underlying <a href="https://github.com/grpc/grpc/tree/master/src/ruby">gRPC</a> library. The logger that you set may be a Ruby stdlib <a href="https://ruby-doc.org/stdlib-2.5.0/libdoc/logger/rdoc/Logger.html"><code>Logger</code></a> as shown below, or a <a href="https://googlecloudplatform.github.io/google-cloud-ruby/#/docs/google-cloud-logging/latest/google/cloud/logging/logger"><code>Google::Cloud::Logging::Logger</code></a> that will write logs to <a href="https://cloud.google.com/logging/">Stackdriver Logging</a>. See <a href="https://github.com/grpc/grpc/blob/master/src/ruby/lib/grpc/logconfig.rb">grpc/logconfig.rb</a> and the gRPC <a href="https://github.com/grpc/grpc/blob/master/src/ruby/spec/spec_helper.rb">spec_helper.rb</a> for additional information.</p>

<p>Configuring a Ruby stdlib logger:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logger</span><span class='tstring_end'>&quot;</span></span>

<span class='kw'>module</span> <span class='const'>MyLogger</span>
  <span class='const'>LOGGER</span> <span class='op'>=</span> <span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='gvar'>$stderr</span><span class='comma'>,</span> <span class='label'>level:</span> <span class='const'>Logger</span><span class='op'>::</span><span class='const'>WARN</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_logger'>logger</span>
    <span class='const'>LOGGER</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># Define a gRPC module-level logger method before grpc/logconfig.rb loads.
</span><span class='kw'>module</span> <span class='const'>GRPC</span>
  <span class='id identifier rubyid_extend'>extend</span> <span class='const'>MyLogger</span>
<span class='kw'>end</span>
</code></pre>

<h2>Supported Ruby Versions</h2>

<p>This library is supported on Ruby 2.3+.</p>

<p>Google provides official support for Ruby versions that are actively supported
by Ruby Coreâ€”that is, Ruby versions that are either in normal maintenance or
in security maintenance, and not end of life. Currently, this means Ruby 2.3
and later. Older versions of Ruby <em>may</em> still work, but are unsupported and not
recommended. See <a href="https://www.ruby-lang.org/en/downloads/branches/">https://www.ruby-lang.org/en/downloads/branches/</a> for details
about the Ruby support schedule.</p>

<p>This library follows <a href="http://semver.org/">Semantic Versioning</a>. It is currently
in major version zero (0.y.z), which means that anything may change at any time
and the public API should not be considered stable.</p>

<h2>Contributing</h2>

<p>Contributions to this library are always welcome and highly encouraged.</p>

<p>See the <a href="https://googlecloudplatform.github.io/google-cloud-ruby/#/docs/guides/contributing">Contributing Guide</a> for more information on how to get started.</p>

<p>Please note that this project is released with a Contributor Code of Conduct. By participating in this project you agree to abide by its terms. See <a href="../CODE_OF_CONDUCT.md">Code of Conduct</a> for more information.</p>

<h2>License</h2>

<p>This library is licensed under Apache 2.0. Full license text is available in <a href="LICENSE">LICENSE</a>.</p>

<h2>Support</h2>

<p>Please <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby/issues">report bugs at the project on Github</a>.
Don&#39;t hesitate to <a href="http://stackoverflow.com/questions/tagged/google-cloud-platform+ruby">ask questions</a> about the client or APIs on <a href="http://stackoverflow.com">StackOverflow</a>.</p>
</div></div>

  <div id="footer">
  <ul class="footer-links">
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby" title="Google Cloud on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> GitHub
      </a>
    </li>
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby/issues" title="Google Cloud issues on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> Issues
      </a>
    </li>
    <li>
      <a href="http://stackoverflow.com/questions/tagged/google-cloud-ruby" title="Google Cloud on StackOverflow">
      <img src="/google-cloud-ruby/img/icon-link-stackoverflow.svg" alt="StackOverflow icon"> StackOverflow
    </a>
    </li>
    <li>
      <a href="http://rubygems.org/gems/google-cloud" title="Google Cloud on RubyGems">
        <img src="/google-cloud-ruby/img/icon-link-package-manager.svg" alt="RubyGems icon"> RubyGems
      </a>
    </li>
  </ul>

  <p>
    Documentation generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>.
  </p>
</div>

</div>
