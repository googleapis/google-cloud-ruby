{"id":"google/cloud/spanner/database","name":"Database","title":["Google","Cloud","Spanner","Database"],"description":"<h1 id=\"database\">Database</h1>\n\n<p>Represents a Cloud Spanner database. To use Cloud Spannerâ€™s read and\nwrite operations, you must first create a database. A database belongs\nto a <a data-custom-type=\"google/cloud/spanner/instance\">Instance</a> and contains tables and indexes. You may create multiple\ndatabases in an <a data-custom-type=\"google/cloud/spanner/instance\">Instance</a>.</p>\n\n<p>See Google::Cloud::Spanner::Instance#databases,\nGoogle::Cloud::Spanner::Instance#database, and\nGoogle::Cloud::Spanner::Instance#create_database.</p>\n\n<p>To read and/or modify data in a Cloud Spanner database, use an instance\nof <a data-custom-type=\"google/cloud/spanner/client\">Google::Cloud::Spanner::Client</a>. See\nGoogle::Cloud::Spanner::Project#client.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L57","resources":[],"examples":[{"caption":"","code":"require \"google/cloud\"\n\nspanner = Google::Cloud::Spanner.new\ninstance = spanner.instance \"my-instance\"\n\njob = instance.create_database \"my-new-database\"\n\njob.done? #=> false\njob.reload! # API call\njob.done? #=> true\n\nif job.error?\n  status = job.error\nelse\n  database = job.database\nend"}],"methods":[{"id":"project_id-instance","type":"instance","name":"project_id","title":["Google","Cloud","Spanner","Database#project_id"],"description":"<p>The unique identifier for the project.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L70","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["String"],"description":""}]},{"id":"instance_id-instance","type":"instance","name":"instance_id","title":["Google","Cloud","Spanner","Database#instance_id"],"description":"<p>The unique identifier for the instance.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L76","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["String"],"description":""}]},{"id":"database_id-instance","type":"instance","name":"database_id","title":["Google","Cloud","Spanner","Database#database_id"],"description":"<p>The unique identifier for the database.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L82","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["String"],"description":""}]},{"id":"path-instance","type":"instance","name":"path","title":["Google","Cloud","Spanner","Database#path"],"description":"<p>The full path for the database resource. Values are of the form\n<code>projects/&lt;project_id&gt;/instances/&lt;instance_id&gt;/databases/&lt;database_id&gt;</code>.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L92","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["String"],"description":""}]},{"id":"state-instance","type":"instance","name":"state","title":["Google","Cloud","Spanner","Database#state"],"description":"<p>The current database state. Possible values are <code>:CREATING</code> and\n<code>:READY</code>.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L102","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["Symbol"],"description":""}]},{"id":"creating?-instance","type":"instance","name":"creating?","title":["Google","Cloud","Spanner","Database#creating?"],"description":"<p>The database is still being created. Operations on the database may\nfail with <code>FAILED_PRECONDITION</code> in this state.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L110","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["Boolean"],"description":""}]},{"id":"ready?-instance","type":"instance","name":"ready?","title":["Google","Cloud","Spanner","Database#ready?"],"description":"<p>The database is fully created and ready for use.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L117","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[{"types":["Boolean"],"description":""}]},{"id":"ddl-instance","type":"instance","name":"ddl","title":["Google","Cloud","Spanner","Database#ddl"],"description":"<p>Retrieve the Data Definition Language (DDL) statements that define\ndatabase structures. DDL statements are used to create, update,\nand delete tables and indexes.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L154","resources":[{"title":"Data Definition Language","link":"https://cloud.google.com/spanner/docs/data-definition-language"}],"examples":[{"caption":"<p>statements are memoized to reduce the number of API calls:</p>","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\n\nstatements = database.ddl # API call\nstatements_2 = database.ddl # No API call"},{"caption":"<p>Use <code>force</code> to retrieve the statements from the service:</p>","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\n\nstatements = database.ddl force: true # API call\nstatements_2 = database.ddl force: true # API call"}],"params":[{"name":"force","types":["Boolean"],"description":"Force the latest DDL statements to be retrieved\nfrom the Spanner service when <code>true</code>. Otherwise the DDL statements\nwill be memoized to reduce the number of API calls made to the\nSpanner service. The default is <code>false</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Array&lt;String&gt;"],"description":"The DDL statements."}]},{"id":"update-instance","type":"instance","name":"update","title":["Google","Cloud","Spanner","Database#update"],"description":"<p>Updates the database schema by adding Data Definition Language (DDL)\nstatements to create, update, and delete tables and indexes.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L200","resources":[{"title":"Data Definition Language","link":"https://cloud.google.com/spanner/docs/data-definition-language"}],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\n\nadd_users_table_sql = %q(\n  CREATE TABLE users (\n    id INT64 NOT NULL,\n    username STRING(25) NOT NULL,\n    name STRING(45) NOT NULL,\n    email STRING(128),\n  ) PRIMARY KEY(id)\n)\n\ndatabase.update statements: [add_users_table_sql]"}],"params":[{"name":"statements","types":["Array<String>"],"description":"The DDL statements to be applied to\nthe database.","optional":true,"default":"[]","nullable":false},{"name":"operation_id","types":["String","nil"],"description":"The operation ID used to perform the\nupdate. When <code>nil</code>, the update request is assigned an\nautomatically-generated operation ID. Specifying an explicit value\nsimplifies determining whether the statements were executed in the\nevent that the update is replayed, or the return value is otherwise\nlost. This value should be unique within the database, and must be a\nvalid identifier: <code>[a-z][a-z0-9_]*</code>. Will raise\nGoogle::Cloud::AlreadyExistsError if the named operation already\nexists. Optional.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/spanner/database/job\">Database::Job</a>"],"description":"The job representing the long-running,\nasynchronous processing of a database schema update operation."}]},{"id":"drop-instance","type":"instance","name":"drop","title":["Google","Cloud","Spanner","Database#drop"],"description":"<p>Drops (deletes) the Cloud Spanner database.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L221","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\n\ndatabase.drop"}],"params":[],"exceptions":[],"returns":[{"types":["Boolean"],"description":"Returns <code>true</code> if the database was deleted."}]},{"id":"policy-instance","type":"instance","name":"policy","title":["Google","Cloud","Spanner","Database#policy"],"description":"<p>Gets the <a href=\"https://cloud.google.com/iam/\">Cloud IAM</a> access control\npolicy for this database.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L261","resources":[{"title":"google.iam.v1.IAMPolicy","link":"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Policy"}],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\n\npolicy = database.policy"},{"caption":"<p>Update the policy by passing a block:</p>","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\n\ndatabase.policy do |p|\n  p.add \"roles/owner\", \"user:owner@example.com\"\nend # 2 API calls"}],"params":[{"name":"yield","types":["block"],"description":"A block for updating the policy. The latest policy\nwill be read from the Spanner service and passed to the block. After\nthe block completes, the modified policy will be written to the\nservice.","optional":true,"nullable":false},{"name":"yield.policy","types":["Policy"],"description":"the current Cloud IAM Policy for this\ndatabase","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/spanner/policy\">Policy</a>"],"description":"The current Cloud IAM Policy for this database."}]},{"id":"policy=-instance","type":"instance","name":"policy=","title":["Google","Cloud","Spanner","Database#policy="],"description":"<p>Updates the <a href=\"https://cloud.google.com/iam/\">Cloud IAM</a> access control\npolicy for this database. The policy should be read from <a data-custom-type=\"google/cloud/spanner/database\" data-method=\"policy-instance\">#policy</a>.\nSee <a data-custom-type=\"google/cloud/spanner/policy\">Google::Cloud::Spanner::Policy</a> for an explanation of the policy\n<code>etag</code> property and how to modify policies.</p>\n\n<p>You can also update the policy by passing a block to <a data-custom-type=\"google/cloud/spanner/database\" data-method=\"policy-instance\">#policy</a>, which\nwill call this method internally after the block completes.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L299","resources":[{"title":"google.iam.v1.IAMPolicy","link":"https://cloud.google.com/spanner/reference/rpc/google.iam.v1#google.iam.v1.Policy"}],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\n\npolicy = database.policy # API call\n\npolicy.add \"roles/owner\", \"user:owner@example.com\"\n\ndatabase.policy = policy # API call"}],"params":[{"name":"new_policy","types":["Policy"],"description":"a new or modified Cloud IAM Policy for this\ndatabase","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/spanner/policy\">Policy</a>"],"description":"The policy returned by the API update operation."}]},{"id":"test_permissions-instance","type":"instance","name":"test_permissions","title":["Google","Cloud","Spanner","Database#test_permissions"],"description":"<p>Tests the specified permissions against the <a href=\"https://cloud.google.com/iam/\">Cloud\nIAM</a> access control policy.</p>","source":"google-cloud-spanner/lib/google/cloud/spanner/database.rb#L346","resources":[{"title":"Managing\nPolicies","link":"https://cloud.google.com/iam/docs/managing-policies"}],"examples":[{"caption":"","code":"require \"google/cloud/spanner\"\n\nspanner = Google::Cloud::Spanner.new\ndatabase = spanner.database \"my-instance\", \"my-database\"\nperms = database.test_permissions \"spanner.databases.get\",\n                                  \"spanner.databases.update\"\nperms.include? \"spanner.databases.get\" #=> true\nperms.include? \"spanner.databases.update\" #=> false"}],"params":[{"name":"permissions","types":["String","Array<String>"],"description":"The set of permissions to\ncheck access for. Permissions with wildcards (such as <code>*</code> or\n<code>storage.*</code>) are not allowed.</p>\n\n<p>The permissions that can be checked on a database are:</p>\n\n<ul>\n  <li>pubsub.databases.create</li>\n  <li>pubsub.databases.list</li>\n  <li>pubsub.databases.update</li>\n  <li>pubsub.databases.updateDdl</li>\n  <li>pubsub.databases.get</li>\n  <li>pubsub.databases.getDdl</li>\n  <li>pubsub.databases.getIamPolicy</li>\n  <li>pubsub.databases.setIamPolicy</li>\n  <li>pubsub.databases.beginReadOnlyTransaction</li>\n  <li>pubsub.databases.beginOrRollbackReadWriteTransaction</li>\n  <li>pubsub.databases.read</li>\n  <li>pubsub.databases.select</li>\n  <li>pubsub.databases.write</li>\n  <li>pubsub.databases.drop</li>\n</ul>","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Array&lt;Strings&gt;"],"description":"The permissions that have access."}]}]}