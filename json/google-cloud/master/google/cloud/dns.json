{"id":"google/cloud/dns","name":"Dns","title":["Google","Cloud","Dns"],"description":"<h1 id=\"google-cloud-dns\">Google Cloud DNS</h1>\n\n<p>Google Cloud DNS is a high-performance, resilient, global DNS service that\nprovides a cost-effective way to make your applications and services\navailable to your users. This programmable, authoritative DNS service can\nbe used to easily publish and manage DNS records using the same\ninfrastructure relied upon by Google. To learn more, read <a href=\"https://cloud.google.com/dns/what-is-cloud-dns\">What is Google\nCloud DNS?</a>.</p>\n\n<p>The goal of google-cloud is to provide an API that is comfortable to\nRubyists. Your authentication credentials are detected automatically in\nGoogle Cloud Platform environments such as Google Compute Engine, Google\nApp Engine and Google Kubernetes Engine. In other environments you can\nconfigure authentication easily, either directly in your code or via\nenvironment variables. Read more about the options for connecting in the\n<a href=\"https://googlecloudplatform.github.io/google-cloud-ruby/#/docs/guides/authentication\">Authentication\nGuide</a>.</p>\n\n<h2 id=\"creating-zones\">Creating Zones</h2>\n\n<p>To get started with Google Cloud DNS, use your DNS Project to create a new\nZone. The second argument to Google::Cloud::Dns::Project#create_zone\nmust be a unique domain name for which you can <a href=\"https://www.google.com/webmasters/verification/home\">verify\nownership</a>.\nSubstitute a domain name of your own (ending with a dot to signify that it\nis <a href=\"https://en.wikipedia.org/wiki/Fully_qualified_domain_name\">fully\nqualified</a>) as\nyou follow along with these examples.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.create_zone \"example-com\", \"example.com.\"\nputs zone.id # unique identifier defined by the server\n</code></pre>\n\n<p>For more information, see <a href=\"https://cloud.google.com/dns/zones/\">Managing\nZones</a>.</p>\n\n<h2 id=\"listing-zones\">Listing Zones</h2>\n\n<p>You can retrieve all the zones in your project.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzones = dns.zones\nzones.each do |zone|\n  puts \"#{zone.name} - #{zone.dns}\"\nend\n</code></pre>\n\n<p>You can also retrieve a single zone by either name or id.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\n</code></pre>\n\n<h2 id=\"listing-records\">Listing Records</h2>\n\n<p>When you create a zone, the Cloud DNS service automatically creates two\nRecord instances for it, providing configuration for Cloud DNS\nnameservers. Let’s take a look at these records.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nrecords = zone.records\nrecords.count #=&gt; 2\nrecords.map &amp;:type #=&gt; [\"NS\", \"SOA\"]\nzone.records.first.data.count #=&gt; 4\nzone.records.first.data #=&gt; [\"ns-cloud-d1.googledomains.com.\", ...]\n</code></pre>\n\n<p>Note that Google::Cloud::Dns::Record#data returns an array. The Cloud\nDNS service only allows the zone to have one Record instance for each name\nand type combination. It supports multiple “resource records” (in this\ncase, the four nameserver addresses) via this <code>data</code> collection.</p>\n\n<h2 id=\"managing-records\">Managing Records</h2>\n\n<p>You can easily add your own records to the zone. Each call to\nGoogle::Cloud::Dns::Zone#add results in a new Cloud DNS Change instance.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nchange = zone.add \"www\", \"A\", 86400, [\"1.2.3.4\"]\nchange.additions.map &amp;:type #=&gt; [\"A\", \"SOA\"]\nchange.deletions.map &amp;:type #=&gt; [\"SOA\"]\n</code></pre>\n\n<p>Whenever you change the set of records belonging to a zone, the zone’s\nstart of authority (SOA) record should be updated with a higher serial\nnumber. The google-cloud library automates this update for you, deleting\nthe old SOA record and adding an updated one, as shown in the example\nabove. You can disable or modify this behavior, of course. See\nGoogle::Cloud::Dns::Zone#update for details.</p>\n\n<p>You can retrieve records by name and type. The name argument can be a\nsubdomain (e.g., <code>www</code>) fragment for convenience, but notice that the\nretrieved record’s domain name is always fully-qualified.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nrecords = zone.records \"www\", \"A\"\nrecords.first.name #=&gt; \"www.example.com.\"\n</code></pre>\n\n<p>You can use Google::Cloud::Dns::Zone#replace to update the <code>ttl</code> and\n<code>data</code> for a record.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nchange = zone.replace \"www\", \"A\", 86400, [\"5.6.7.8\"]\n</code></pre>\n\n<p>Or, you can use Google::Cloud::Dns::Zone#modify to update just the <code>ttl</code>\nor <code>data</code>, without the risk of inadvertently changing values that you wish\nto leave unchanged.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nchange = zone.modify \"www\", \"A\" do |r|\n  r.ttl = 3600 # change only the TTL\nend\n</code></pre>\n\n<p>You can also delete records by name and type.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nchange = zone.remove \"www\", \"A\"\nrecord = change.deletions.first\n</code></pre>\n\n<p>The best way to add, remove, and update multiple records in a single\n<a href=\"https://cloud.google.com/dns/records\">transaction</a> is to call\nGoogle::Cloud::Dns::Zone#update with a block. See\n<a data-custom-type=\"google/cloud/dns/zone/transaction\">Google::Cloud::Dns::Zone::Transaction</a>.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nchange = zone.update do |tx|\n  tx.add     \"www\", \"A\",  86400, \"1.2.3.4\"\n  tx.remove  \"example.com.\", \"TXT\"\n  tx.replace \"example.com.\", \"MX\", 86400, [\"10 mail1.example.com.\",\n                                           \"20 mail2.example.com.\"]\n  tx.modify \"www.example.com.\", \"CNAME\" do |r|\n    r.ttl = 86400 # only change the TTL\n  end\nend\n</code></pre>\n\n<p>Finally, you can add and delete records by reference, using\nGoogle::Cloud::Dns::Zone#update.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nto_add = zone.record \"www\", \"AAAA\", 86400, [\"2607:f8b0:400a:801::1005\"]\nto_delete = zone.records \"www\", \"A\"\nchange = zone.update to_add, to_delete\n</code></pre>\n\n<h2 id=\"listing-changes\">Listing Changes</h2>\n\n<p>Because the transactions you execute against your zone do not always\ncomplete immediately, you can retrieve and inspect changes.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nchanges = zone.changes\nchanges.each do |change|\n  puts \"#{change.id} - #{change.started_at} - #{change.status}\"\nend\n</code></pre>\n\n<h2 id=\"importing-and-exporting-zone-files\">Importing and exporting zone files</h2>\n\n<p>You can import from a zone file. Because the Cloud DNS service only allows\nthe zone to have one Record instance for each name and type combination,\nlines may be merged as needed into records with multiple <code>data</code> values.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\nchange = zone.import \"path/to/db.example.com\"\n</code></pre>\n\n<p>You can also export to a zone file.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new\nzone = dns.zone \"example-com\"\n\nzone.export \"path/to/db.example.com\"\n</code></pre>\n\n<h2 id=\"configuring-retries-and-timeout\">Configuring retries and timeout</h2>\n\n<p>You can configure how many times API requests may be automatically\nretried. When an API request fails, the response will be inspected to see\nif the request meets criteria indicating that it may succeed on retry,\nsuch as <code>500</code> and <code>503</code> status codes or a specific internal error code\nsuch as <code>rateLimitExceeded</code>. If it meets the criteria, the request will be\nretried after a delay. If another error occurs, the delay will be\nincreased before a subsequent attempt, until the <code>retries</code> limit is\nreached.</p>\n\n<p>You can also set the request <code>timeout</code> value in seconds.</p>\n\n<pre><code class=\"language-ruby\">require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new retries: 10, timeout: 120\n</code></pre>","source":"google-cloud-dns/lib/google/cloud/dns.rb#L275","resources":[],"examples":[],"methods":[{"id":"new-class","type":"class","name":"new","title":["Google","Cloud","Dns.new"],"description":"<p>Creates a new <code>Project</code> instance connected to the DNS service.\nEach call creates a new connection.</p>\n\n<p>For more information on connecting to Google Cloud see the\n<a href=\"https://googlecloudplatform.github.io/google-cloud-ruby/#/docs/guides/authentication\">Authentication\nGuide</a>.</p>","source":"google-cloud-dns/lib/google/cloud/dns.rb#L316","resources":[],"examples":[{"caption":"","code":"require \"google/cloud/dns\"\n\ndns = Google::Cloud::Dns.new(\n        project_id: \"my-dns-project\",\n        credentials: \"/path/to/keyfile.json\"\n      )\n\nzone = dns.zone \"example-com\""}],"params":[{"name":"project_id","types":["String"],"description":"Identifier for a DNS project. If not present,\nthe default project for the credentials is used.","optional":true,"default":"nil","nullable":true},{"name":"credentials","types":["String","Hash","Google::Auth::Credentials"],"description":"The path to\nthe keyfile as a String, the contents of the keyfile as a Hash, or a\nGoogle::Auth::Credentials object. (See <a data-custom-type=\"google/cloud/dns/credentials\">Dns::Credentials</a>)","optional":true,"default":"nil","nullable":true},{"name":"scope","types":["String","Array<String>"],"description":"The OAuth 2.0 scopes controlling\nthe set of resources and operations that the connection can access.\nSee <a href=\"https://developers.google.com/identity/protocols/OAuth2\">Using OAuth 2.0 to Access Google\nAPIs</a>.</p>\n\n<p>The default scope is:</p>\n\n<ul>\n  <li><code>https://www.googleapis.com/auth/ndev.clouddns.readwrite</code></li>\n</ul>","optional":true,"default":"nil","nullable":true},{"name":"retries","types":["Integer"],"description":"Number of times to retry requests on server\nerror. The default value is <code>3</code>. Optional.","optional":true,"default":"nil","nullable":true},{"name":"timeout","types":["Integer"],"description":"Default timeout to use in requests. Optional.","optional":true,"default":"nil","nullable":true},{"name":"project","types":["String"],"description":"Alias for the <code>project_id</code> argument. Deprecated.","optional":true,"default":"nil","nullable":true},{"name":"keyfile","types":["String"],"description":"Alias for the <code>credentials</code> argument.\nDeprecated.","optional":true,"default":"nil","nullable":true}],"exceptions":[{"type":"ArgumentError","description":""}],"returns":[{"types":["<a data-custom-type=\"google/cloud/dns/project\">Google::Cloud::Dns::Project</a>"],"description":""}]},{"id":"configure-class","type":"class","name":"configure","title":["Google","Cloud","Dns.configure"],"description":"<p>Configure the Google Cloud DNS library.</p>\n\n<p>The following DNS configuration parameters are supported:</p>\n\n<ul>\n  <li><code>project_id</code> - (String) Identifier for a DNS project. (The\nparameter <code>project</code> is considered deprecated, but may also be used.)</li>\n  <li><code>credentials</code> - (String, Hash, Google::Auth::Credentials) The path to\nthe keyfile as a String, the contents of the keyfile as a Hash, or a\nGoogle::Auth::Credentials object. (See <a data-custom-type=\"google/cloud/dns/credentials\">Dns::Credentials</a>) (The\nparameter <code>keyfile</code> is considered deprecated, but may also be used.)</li>\n  <li><code>scope</code> - (String, Array<String>) The OAuth 2.0 scopes controlling\nthe set of resources and operations that the connection can access.</String></li>\n  <li><code>retries</code> - (Integer) Number of times to retry requests on server\nerror.</li>\n  <li><code>timeout</code> - (Integer) Default timeout to use in requests.</li>\n</ul>","source":"google-cloud-dns/lib/google/cloud/dns.rb#L383","resources":[],"examples":[],"params":[{"name":"yield","types":["block"],"description":"","optional":true,"nullable":false}],"exceptions":[],"returns":[{"types":["Google::Cloud::Config"],"description":"The configuration object the\nGoogle::Cloud::Dns library uses."}]}]}