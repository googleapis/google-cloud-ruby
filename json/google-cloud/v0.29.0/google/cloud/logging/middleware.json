{"id":"google/cloud/logging/middleware","name":"Middleware","title":["Google","Cloud","Logging","Middleware"],"description":"","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L21","resources":[],"examples":[],"methods":[{"id":"logger-instance","type":"instance","name":"logger","title":["Google","Cloud","Logging","Middleware#logger"],"description":"<p>The Google::Cloud::Logging::Logger instance</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L34","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"initialize-constructor","type":"constructor","name":"initialize","title":["Google","Cloud","Logging","Middleware#initialize"],"description":"<p>Create a new AppEngine logging Middleware.</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L61","resources":[],"examples":[],"params":[{"name":"app","types":["Rack Application"],"description":"Rack application","optional":false,"nullable":false},{"name":"logger","types":["Google::Cloud::Logging::Logger"],"description":"A logger to be used by\nthis middleware. The middleware will be interacting with the logger\nto track Stackdriver request trace ID. It also properly sets\nenv[“rack.logger”] to this assigned logger for accessing. If not\nspecified, a default logger with be used.","optional":true,"default":"nil","nullable":true},{"name":"project_id","types":["String"],"description":"Project identifier for the Stackdriver\nLogging service. Used to create a default logger if one isn’t\nspecified and a service account is used for authentication.\nOptional.","optional":true,"default":"nil","nullable":true},{"name":"keyfile","types":["String","Hash"],"description":"Keyfile downloaded from Google Cloud. If\nfile path the file must be readable. Used to create a default logger\nif one isn’t specified and a service account is used for\nauthentication. Optional.","optional":true,"default":"nil","nullable":true},{"name":"log_name_map","types":["Hash"],"description":"A map from URI path to log name override.\nThe path may be a string or regex. If a request path matches an\nentry in this map, the log name is set accordingly, otherwise the\nlogger’s default log_name is used.","optional":true,"default":"DEFAULT_LOG_NAME_MAP","nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/logging/middleware\">Google::Cloud::Logging::Middleware</a>"],"description":"A new\nGoogle::Cloud::Logging::Middleware instance"}]},{"id":"call-instance","type":"instance","name":"call","title":["Google","Cloud","Logging","Middleware#call"],"description":"<p>Rack middleware entry point. In most Rack based frameworks, a request\nis served by one thread. So entry point, we associate the GCP request\ntrace_id with the current thread’s object_id in logger. All the logs\nwritten by logger beyond this point will carry this request’s\ntrace_id. Untrack the trace_id with this thread upon exiting.</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L86","resources":[],"examples":[],"params":[{"name":"env","types":["Hash"],"description":"Rack environment hash","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Rack::Response"],"description":"The response from downstream Rack app"}]},{"id":"build_monitored_resource-class","type":"class","name":"build_monitored_resource","title":["Google","Cloud","Logging","Middleware.build_monitored_resource"],"description":"<p>Construct a monitored resource based on the given type and label if\nboth are provided. Otherwise, construct a default monitored resource\nbased on the current environment.</p>","source":"google-cloud-logging/lib/google/cloud/logging/middleware.rb#L177","resources":[{"title":"Monitored Resources and Services","link":"https://cloud.google.com/logging/docs/api/v2/resource-list"}],"examples":[{"caption":"<p>If both type and labels are provided, it returns resource:</p>","code":"rc = Google::Cloud::Logging::Middleware.build_monitored_resource(\n       \"aws_ec2_instance\",\n       {\n         instance_id: \"ec2-id\",\n         aws_account: \"aws-id\"\n       }\n     )\nrc.type   #=> \"aws_ec2_instance\"\nrc.labels #=> { instance_id: \"ec2-id\", aws_account: \"aws-id\" }"},{"caption":"<p>If running from GAE, returns default resource:</p>","code":"rc = Google::Cloud::Logging::Middleware.build_monitored_resource\nrc.type   #=> \"gae_app\"\nrc.labels # { module_id: [GAE module name],\n          #   version_id: [GAE module version] }"},{"caption":"<p>If running from GKE, returns default resource:</p>","code":"rc = Google::Cloud::Logging::Middleware.build_monitored_resource\nrc.type   #=> \"container\"\nrc.labels # { cluster_name: [GKE cluster name],\n          #   namespace_id: [GKE namespace_id] }"},{"caption":"<p>If running from GCE, return default resource:</p>","code":"rc = Google::Cloud::Logging::Middleware.build_monitored_resource\nrc.type   #=> \"gce_instance\"\nrc.labels # { instance_id: [GCE VM instance id],\n          #   zone: [GCE vm group zone] }"},{"caption":"<p>Otherwise default to generic “global” type:</p>","code":"rc = Google::Cloud::Logging::Middleware.build_monitored_resource\nrc.type   #=> \"global\"\nrc.labels #=> {}"}],"params":[{"name":"type","types":["String"],"description":"Type of Google::Cloud::Logging::Resource","optional":true,"default":"nil","nullable":true},{"name":"labels","types":["Hash<String, String>"],"description":"Metadata lebels of\nGoogle::Cloud::Logging::Resource","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"google/cloud/logging/resource\">Google::Cloud::Logging::Resource</a>"],"description":"An Resource object with\ntype and labels"}]}]}