{"id":"gcloud/pubsub/topic","name":"Topic","title":["Gcloud","Pubsub","Topic"],"description":"<h1 id=\"topic\">Topic</h1>\n\n<p>A named resource to which messages are published.</p>","source":"lib/gcloud/pubsub/topic.rb#L38","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\ntopic.publish \"task completed\""}],"methods":[{"id":"name-instance","type":"instance","name":"name","title":["Gcloud","Pubsub","Topic#name"],"description":"<p>The name of the topic in the form of\n“/projects/project-identifier/topics/topic-name”.</p>","source":"lib/gcloud/pubsub/topic.rb#L69","resources":[],"examples":[],"params":[],"exceptions":[],"returns":[]},{"id":"delete-instance","type":"instance","name":"delete","title":["Gcloud","Pubsub","Topic#delete"],"description":"<p>Permanently deletes the topic.</p>","source":"lib/gcloud/pubsub/topic.rb#L87","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\ntopic.delete"}],"params":[],"exceptions":[],"returns":[{"types":["Boolean"],"description":"Returns <code>true</code> if the topic was deleted."}]},{"id":"subscribe-instance","type":"instance","name":"subscribe","title":["Gcloud","Pubsub","Topic#subscribe"],"description":"<p>Creates a new <a data-custom-type=\"gcloud/pubsub/subscription\">Subscription</a> object on the current Topic.</p>","source":"lib/gcloud/pubsub/topic.rb#L140","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nsub = topic.subscribe \"my-topic-sub\"\nputs sub.name # => \"my-topic-sub\""},{"caption":"<p>The name is optional, and will be generated if not given:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nsub = topic.subscribe \"my-topic-sub\"\nputs sub.name # => \"generated-sub-name\""},{"caption":"<p>Wait 2 minutes for acknowledgement and push all to an endpoint:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nsub = topic.subscribe \"my-topic-sub\",\n                      deadline: 120,\n                      endpoint: \"https://example.com/push\""}],"params":[{"name":"subscription_name","types":["String"],"description":"Name of the new subscription. Must\nstart with a letter, and contain only letters ([A-Za-z]), numbers\n([0-9], dashes (-), underscores (_), periods (.), tildes (~), plus (+)\nor percent signs (%). It must be between 3 and 255 characters in\nlength, and it must not start with “goog”.","optional":false,"nullable":false},{"name":"deadline","types":["Integer"],"description":"The maximum number of seconds after a\nsubscriber receives a message before the subscriber should acknowledge\nthe message.","optional":true,"default":"nil","nullable":true},{"name":"endpoint","types":["String"],"description":"A URL locating the endpoint to which messages\nshould be pushed.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"gcloud/pubsub/subscription\">Gcloud::Pubsub::Subscription</a>"],"description":""}]},{"id":"subscription-instance","type":"instance","name":"subscription","title":["Gcloud","Pubsub","Topic#subscription"],"description":"<p>Retrieves subscription by name.</p>","source":"lib/gcloud/pubsub/topic.rb#L181","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nsubscription = topic.subscription \"my-topic-subscription\"\nputs subscription.name"},{"caption":"<p>Skip the lookup against the service with <code>skip_lookup</code>:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\n# No API call is made to retrieve the subscription information.\nsubscription = pubsub.subscription \"my-sub\", skip_lookup: true\nputs subscription.name"}],"params":[{"name":"subscription_name","types":["String"],"description":"Name of a subscription.","optional":false,"nullable":false},{"name":"skip_lookup","types":["Boolean"],"description":"Optionally create a <a data-custom-type=\"gcloud/pubsub/subscription\">Subscription</a> object\nwithout verifying the subscription resource exists on the Pub/Sub\nservice. Calls made on this object will raise errors if the service\nresource does not exist. Default is <code>false</code>.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"gcloud/pubsub/subscription\">Gcloud::Pubsub::Subscription</a>","nil"],"description":"Returns <code>nil</code> if\nthe subscription does not exist."}]},{"id":"subscriptions-instance","type":"instance","name":"subscriptions","title":["Gcloud","Pubsub","Topic#subscriptions"],"description":"<p>Retrieves a list of subscription names for the given project.</p>","source":"lib/gcloud/pubsub/topic.rb#L226","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nsubscription = topic.subscriptions\nsubscriptions.each do |subscription|\n  puts subscription.name\nend"},{"caption":"<p>Retrieve all subscriptions: (See <a data-custom-type=\"gcloud/pubsub/subscription/list\" data-method=\"all-instance\">Subscription::List#all</a>)</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nsubscription = topic.subscriptions\nsubscriptions.all do |subscription|\n  puts subscription.name\nend"}],"params":[{"name":"token","types":["String"],"description":"The <code>token</code> value returned by the last call to\n<code>subscriptions</code>; indicates that this is a continuation of a call, and\nthat the system should return the next page of data.","optional":true,"default":"nil","nullable":true},{"name":"max","types":["Integer"],"description":"Maximum number of subscriptions to return.","optional":true,"default":"nil","nullable":true}],"exceptions":[],"returns":[{"types":["Array&lt;<a data-custom-type=\"gcloud/pubsub/subscription\">Subscription</a>&gt;"],"description":"(See <a data-custom-type=\"gcloud/pubsub/subscription/list\">Subscription::List</a>)"}]},{"id":"publish-instance","type":"instance","name":"publish","title":["Gcloud","Pubsub","Topic#publish"],"description":"<p>Publishes one or more messages to the topic.</p>","source":"lib/gcloud/pubsub/topic.rb#L289","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nmsg = topic.publish \"new-message\""},{"caption":"<p>A message can be published using a File object:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nmsg = topic.publish File.open(\"message.txt\")"},{"caption":"<p>Additionally, a message can be published with attributes:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nmsg = topic.publish \"new-message\",\n                    foo: :bar,\n                    this: :that"},{"caption":"<p>Multiple messages can be sent at the same time using a block:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\nmsgs = topic.publish do |batch|\n  batch.publish \"new-message-1\", foo: :bar\n  batch.publish \"new-message-2\", foo: :baz\n  batch.publish \"new-message-3\", foo: :bif\nend"}],"params":[{"name":"data","types":["String","File"],"description":"The message data.","optional":true,"default":"nil","nullable":true},{"name":"attributes","types":["Hash"],"description":"Optional attributes for the message.","optional":true,"default":"{}","nullable":false},{"name":"yield","types":["block"],"description":"a block for publishing multiple messages in one request","optional":true,"nullable":false},{"name":"yield.batch","types":["Topic::Batch"],"description":"the batch object","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"gcloud/pubsub/message\">Message</a>","Array&lt;<a data-custom-type=\"gcloud/pubsub/message\">Message</a>&gt;"],"description":"Returns the published message when\ncalled without a block, or an array of messages when called with a\nblock."}]},{"id":"policy-instance","type":"instance","name":"policy","title":["Gcloud","Pubsub","Topic#policy"],"description":"<p>Gets the <a href=\"https://cloud.google.com/iam/\">Cloud IAM</a> access control\npolicy for this topic.</p>","source":"lib/gcloud/pubsub/topic.rb#L347","resources":[{"title":"google.iam.v1.IAMPolicy","link":"https://cloud.google.com/pubsub/reference/rpc/google.iam.v1#iampolicy"}],"examples":[{"caption":"<p>Policy values are memoized to reduce the number of API calls:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\ntopic = pubsub.topic \"my-topic\"\n\npolicy = topic.policy # API call\npolicy_2 = topic.policy # No API call"},{"caption":"<p>Use <code>force</code> to retrieve the latest policy from the service:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\ntopic = pubsub.topic \"my-topic\"\n\npolicy = topic.policy force: true # API call\npolicy_2 = topic.policy force: true # API call"},{"caption":"<p>Update the policy by passing a block:</p>","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\ntopic = pubsub.topic \"my-topic\"\n\npolicy = topic.policy do |p|\n  p.add \"roles/owner\", \"user:owner@example.com\"\nend # 2 API calls"}],"params":[{"name":"force","types":["Boolean"],"description":"Force the latest policy to be retrieved from the\nPub/Sub service when <code>true</code>. Otherwise the policy will be memoized to\nreduce the number of API calls made to the Pub/Sub service. The\ndefault is <code>false</code>.","optional":true,"default":"nil","nullable":true},{"name":"yield","types":["block"],"description":"A block for updating the policy. The latest policy will\nbe read from the Pub/Sub service and passed to the block. After the\nblock completes, the modified policy will be written to the service.","optional":true,"nullable":false},{"name":"yield.policy","types":["Policy"],"description":"the current Cloud IAM Policy for this topic","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"gcloud/pubsub/policy\">Policy</a>"],"description":"the current Cloud IAM Policy for this topic"}]},{"id":"policy=-instance","type":"instance","name":"policy=","title":["Gcloud","Pubsub","Topic#policy="],"description":"<p>Updates the <a href=\"https://cloud.google.com/iam/\">Cloud IAM</a> access control\npolicy for this topic. The policy should be read from <a data-custom-type=\"gcloud/pubsub/topic\" data-method=\"policy-instance\">#policy</a>. See\n<a data-custom-type=\"gcloud/pubsub/policy\">Gcloud::Pubsub::Policy</a> for an explanation of the policy <code>etag</code>\nproperty and how to modify policies.</p>\n\n<p>You can also update the policy by passing a block to <a data-custom-type=\"gcloud/pubsub/topic\" data-method=\"policy-instance\">#policy</a>, which\nwill call this method internally after the block completes.</p>","source":"lib/gcloud/pubsub/topic.rb#L388","resources":[{"title":"google.iam.v1.IAMPolicy","link":"https://cloud.google.com/pubsub/reference/rpc/google.iam.v1#iampolicy"}],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\ntopic = pubsub.topic \"my-topic\"\n\npolicy = topic.policy # API call\n\npolicy.add \"roles/owner\", \"user:owner@example.com\"\n\ntopic.policy = policy # API call"}],"params":[{"name":"new_policy","types":["Policy"],"description":"a new or modified Cloud IAM Policy for this\ntopic","optional":false,"nullable":false}],"exceptions":[],"returns":[]},{"id":"test_permissions-instance","type":"instance","name":"test_permissions","title":["Gcloud","Pubsub","Topic#test_permissions"],"description":"<p>Tests the specified permissions against the <a href=\"https://cloud.google.com/iam/\">Cloud\nIAM</a> access control policy.</p>","source":"lib/gcloud/pubsub/topic.rb#L428","resources":[{"title":"Managing\nPolicies","link":"https://cloud.google.com/iam/docs/managing-policies"}],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\ntopic = pubsub.topic \"my-topic\"\nperms = topic.test_permissions \"pubsub.topics.get\",\n                               \"pubsub.topics.publish\"\nperms.include? \"pubsub.topics.get\" #=> true\nperms.include? \"pubsub.topics.publish\" #=> false"}],"params":[{"name":"permissions","types":["String","Array<String>"],"description":"The set of permissions to\ncheck access for. Permissions with wildcards (such as <code>*</code> or\n<code>storage.*</code>) are not allowed.</p>\n\n<p>The permissions that can be checked on a topic are:</p>\n\n<ul>\n  <li>pubsub.topics.publish</li>\n  <li>pubsub.topics.attachSubscription</li>\n  <li>pubsub.topics.get</li>\n  <li>pubsub.topics.delete</li>\n  <li>pubsub.topics.update</li>\n  <li>pubsub.topics.getIamPolicy</li>\n  <li>pubsub.topics.setIamPolicy</li>\n</ul>","optional":false,"nullable":false}],"exceptions":[],"returns":[{"types":["Array&lt;Strings&gt;"],"description":"The permissions that have access."}]},{"id":"exists?-instance","type":"instance","name":"exists?","title":["Gcloud","Pubsub","Topic#exists?"],"description":"<p>Determines whether the topic exists in the Pub/Sub service.</p>","source":"lib/gcloud/pubsub/topic.rb#L448","resources":[],"examples":[{"caption":"","code":"require \"gcloud\"\n\ngcloud = Gcloud.new\npubsub = gcloud.pubsub\n\ntopic = pubsub.topic \"my-topic\"\ntopic.exists? #=> true"}],"params":[],"exceptions":[],"returns":[{"types":["Boolean"],"description":""}]}]}